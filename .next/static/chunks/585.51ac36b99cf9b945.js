"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[585],{1585:function(e,t,r){r.r(t),r.d(t,{createOrReadKeylessAction:function(){return createOrReadKeylessAction},deleteKeylessAction:function(){return deleteKeylessAction},syncKeylessConfigAction:function(){return syncKeylessConfigAction}});var i=r(8670),n=r(4033),a=r(1878);let o=(0,a.t5)({packageName:"@clerk/nextjs"});var l=r(2096);r(9646),r(1023),r(7382),r(7521);var c=r(6053),u=r(2601);let h="__clerk_keys_";async function hashString(e){let t=new TextEncoder,r=t.encode(e),i=await crypto.subtle.digest("SHA-256",r),n=Array.from(new Uint8Array(i)),a=n.map(e=>e.toString(16).padStart(2,"0")).join("");return a.slice(0,16)}async function getKeylessCookieName(){let e=u.env.PWD;if(!e)return`${h}0`;let t=e.split("/").filter(Boolean).slice(-3).reverse().join("/"),r=await hashString(t);return`${h}${r}`}async function getKeylessCookieValue(e){let t;if(!c.h)return;let r=await getKeylessCookieName();try{r&&(t=JSON.parse(e(r)||"{}"))}catch{t=void 0}return t}let p={secure:!1,httpOnly:!1,sameSite:"lax"};async function syncKeylessConfigAction(e){var t,r,a,o,c;let{claimUrl:u,publishableKey:h,secretKey:m,returnUrl:g}=e,y=await (0,i.cookies)(),k=new Request("https://placeholder.com",{headers:await (0,i.headers)()}),_=await getKeylessCookieValue(e=>{var t;return null==(t=y.get(e))?void 0:t.value}),S=(null==_?void 0:_.publishableKey)===h,T=(null==_?void 0:_.secretKey)===m;(!S||!T)&&(y.set(await getKeylessCookieName(),JSON.stringify({claimUrl:u,publishableKey:h,secretKey:m}),p),t="AuthStatus",(((r=l._G.Attributes[t])in k?k[r]:void 0)||(a=l._G.Headers[t],function(e){try{let{headers:t,nextUrl:r,cookies:i}=e||{};return"function"==typeof(null==t?void 0:t.get)&&"function"==typeof(null==r?void 0:r.searchParams.get)&&"function"==typeof(null==i?void 0:i.get)}catch{return!1}}(k)||function(e){try{let{headers:t}=e||{};return"function"==typeof(null==t?void 0:t.get)}catch{return!1}}(k)?k.headers.get(a):k.headers[a]||k.headers[a.toLowerCase()]||(null==(c=null==(o=k.socket)?void 0:o._httpMessage)?void 0:c.getHeader(a))))&&(0,n.redirect)(`/clerk-sync-keyless?returnUrl=${g}`,n.RedirectType.replace))}async function createOrReadKeylessAction(){if(!c.h)return null;let e=await r.e(610).then(r.bind(r,9610)).then(e=>e.createOrReadKeyless()).catch(()=>null);if(!e)return o.throwMissingPublishableKeyError(),null;let{clerkDevelopmentCache:t,createKeylessModeMessage:n}=await r.e(825).then(r.bind(r,9825));null==t||t.log({cacheKey:e.publishableKey,msg:n(e)});let{claimUrl:a,publishableKey:l,secretKey:u,apiKeysUrl:h}=e;return(await (0,i.cookies)()).set(await getKeylessCookieName(),JSON.stringify({claimUrl:a,publishableKey:l,secretKey:u}),p),{claimUrl:a,publishableKey:l,apiKeysUrl:h}}async function deleteKeylessAction(){c.h&&await r.e(610).then(r.bind(r,9610)).then(e=>e.removeKeyless()).catch(()=>{})}},4981:function(e,t){t.Qc=function(e,t){let i=new r,n=e.length;if(n<2)return i;let a=t?.decode||decode,o=0;do{let t=e.indexOf("=",o);if(-1===t)break;let r=e.indexOf(";",o),l=-1===r?n:r;if(t>l){o=e.lastIndexOf(";",t-1)+1;continue}let c=startIndex(e,o,t),u=endIndex(e,t,c),h=e.slice(c,u);if(void 0===i[h]){let r=startIndex(e,t+1,l),n=endIndex(e,l,r),o=a(e.slice(r,n));i[h]=o}o=l+1}while(o<n);return i},Object.prototype.toString;let r=(()=>{let C=function(){};return C.prototype=Object.create(null),C})();function startIndex(e,t,r){do{let r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r);return r}function endIndex(e,t,r){for(;t>r;){let r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function decode(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},3139:function(e){let isObject=e=>"object"==typeof e&&null!==e,t=Symbol("skip"),isObjectCustom=e=>isObject(e)&&!(e instanceof RegExp)&&!(e instanceof Error)&&!(e instanceof Date),mapObject=(e,r,i,n=new WeakMap)=>{if(i={deep:!1,target:{},...i},n.has(e))return n.get(e);n.set(e,i.target);let{target:a}=i;delete i.target;let mapArray=e=>e.map(e=>isObjectCustom(e)?mapObject(e,r,i,n):e);if(Array.isArray(e))return mapArray(e);for(let[o,l]of Object.entries(e)){let c=r(o,l,e);if(c===t)continue;let[u,h,{shouldRecurse:p=!0}={}]=c;"__proto__"!==u&&(i.deep&&p&&isObjectCustom(h)&&(h=Array.isArray(h)?mapArray(h):mapObject(h,r,i,n)),a[u]=h)}return a};e.exports=(e,t,r)=>{if(!isObject(e))throw TypeError(`Expected an object, got \`${e}\` (${typeof e})`);return mapObject(e,t,r)},e.exports.mapObjectSkip=t},2002:function(e,t,r){r.r(t),r.d(t,{snakeCase:function(){return snakeCase}});var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function lowerCase(e){return e.toLowerCase()}"function"==typeof SuppressedError&&SuppressedError;var i=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],n=/[^A-Z0-9]+/gi;function replace(e,t,r){return t instanceof RegExp?e.replace(t,r):t.reduce(function(e,t){return e.replace(t,r)},e)}function snakeCase(e,t){var r;return void 0===t&&(t={}),void 0===(r=__assign({delimiter:"_"},t))&&(r={}),function(e,t){void 0===t&&(t={});for(var r=t.splitRegexp,a=t.stripRegexp,o=t.transform,l=void 0===o?lowerCase:o,c=t.delimiter,u=void 0===c?" ":c,h=replace(replace(e,void 0===r?i:r,"$1\x00$2"),void 0===a?n:a,"\x00"),p=0,m=h.length;"\x00"===h.charAt(p);)p++;for(;"\x00"===h.charAt(m-1);)m--;return h.slice(p,m).split("\x00").map(l).join(u)}(e,__assign({delimiter:"."},r))}},9504:function(e,t,r){let i=r(3139),{snakeCase:n}=r(2002),a={}.constructor;e.exports=function(e,t){if(Array.isArray(e)){if(e.some(e=>e.constructor!==a))throw Error("obj must be array of plain objects")}else if(e.constructor!==a)throw Error("obj must be an plain object");return i(e,function(e,r){var i;return[t.exclude.some(function(t){return"string"==typeof t?t===e:t.test(e)})?e:n(e,t.parsingOptions),r,(i=t).shouldRecurse?{shouldRecurse:i.shouldRecurse(e,r)}:void 0]},t=Object.assign({deep:!0,exclude:[],parsingOptions:{}},t))}},7382:function(e,t,r){r.d(t,{YU:function(){return n},h2:function(){return a},oh:function(){return o},rE:function(){return i}});var i={InvalidSecretKey:"clerk_key_invalid"},n={TokenExpired:"token-expired",TokenInvalid:"token-invalid",TokenInvalidAlgorithm:"token-invalid-algorithm",TokenInvalidAuthorizedParties:"token-invalid-authorized-parties",TokenInvalidSignature:"token-invalid-signature",TokenNotActiveYet:"token-not-active-yet",TokenIatInTheFuture:"token-iat-in-the-future",TokenVerificationFailed:"token-verification-failed",InvalidSecretKey:"secret-key-invalid",LocalJWKMissing:"jwk-local-missing",RemoteJWKFailedToLoad:"jwk-remote-failed-to-load",RemoteJWKInvalid:"jwk-remote-invalid",RemoteJWKMissing:"jwk-remote-missing",JWKFailedToResolve:"jwk-failed-to-resolve",JWKKidMismatch:"jwk-kid-mismatch"},a={ContactSupport:"Contact support@clerk.com",EnsureClerkJWT:"Make sure that this is a valid Clerk generate JWT.",SetClerkJWTKey:"Set the CLERK_JWT_KEY environment variable.",SetClerkSecretKey:"Set the CLERK_SECRET_KEY environment variable.",EnsureClockSync:"Make sure your system clock is in sync (e.g. turn off and on automatic time synchronization)."},o=class _TokenVerificationError extends Error{constructor({action:e,message:t,reason:r}){super(t),Object.setPrototypeOf(this,_TokenVerificationError.prototype),this.reason=r,this.message=t,this.action=e}getFullMessage(){return`${[this.message,this.action].filter(e=>e).join(" ")} (reason=${this.reason}, token-carrier=${this.tokenCarrier})`}}},2096:function(e,t,r){r.d(t,{_G:function(){return k},sA:function(){return createAuthenticateRequest},gf:function(){return createBackendApiClient},WX:function(){return verifyToken}});var i=r(9646),n=r(1023),a=r(7382),o=r(1878),l=r(9504),c=r(5715),u=r(940);r(7521);var parsePermissions=({per:e,fpm:t})=>{if(!e||!t)return{permissions:[],featurePermissionMap:[]};let r=e.split(",").map(e=>e.trim()),i=t.split(",").map(e=>Number.parseInt(e.trim(),10)).map(e=>e.toString(2).padStart(r.length,"0").split("").map(e=>Number.parseInt(e,10)).reverse()).filter(Boolean);return{permissions:r,featurePermissionMap:i}},__experimental_JWTPayloadToAuthObjectProperties=e=>{let t,r,i,n;let a=e.fva??null,o=e.sts??null;if(2===e.v){if(e.o){t=e.o?.id,i=e.o?.slg,e.o?.rol&&(r=`org:${e.o?.rol}`);let{org:a}=(0,u.Ly)(e.fea),{permissions:o,featurePermissionMap:l}=parsePermissions({per:e.o?.per,fpm:e.o?.fpm});n=function({features:e,permissions:t,featurePermissionMap:r}){if(!e||!t||!r)return[];let i=[];for(let n=0;n<e.length;n++){let a=e[n];if(n>=r.length)continue;let o=r[n];if(o)for(let e=0;e<o.length;e++)1===o[e]&&i.push(`org:${a}:${t[e]}`)}return i}({features:a,featurePermissionMap:l,permissions:o})}}else t=e.org_id,r=e.org_role,i=e.org_slug,n=e.org_permissions;return{sessionClaims:e,sessionId:e.sid,sessionStatus:o,actor:e.act,userId:e.sub,orgId:t,orgRole:r,orgSlug:i,orgPermissions:n,factorVerificationAge:a}},h=r(4981);function s(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function D(e){return e&&e.sensitive?"":"i"}function match(e,t){try{var r,i,n,a,o;return r=[],i=function P(e,t,r){var i;return e instanceof RegExp?function(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,i=0,n=r.exec(e.source);n;)t.push({name:n[1]||i++,prefix:"",suffix:"",modifier:"",pattern:""}),n=r.exec(e.source);return e}(e,t):Array.isArray(e)?(i=e.map(function(e){return P(e,t,r).source}),new RegExp("(?:".concat(i.join("|"),")"),D(r))):function(e,t,r){void 0===r&&(r={});for(var i=r.strict,n=void 0!==i&&i,a=r.start,o=r.end,l=r.encode,c=void 0===l?function(e){return e}:l,u=r.delimiter,h=r.endsWith,p="[".concat(s(void 0===h?"":h),"]|$"),m="[".concat(s(void 0===u?"/#?":u),"]"),g=void 0===a||a?"^":"",y=0;y<e.length;y++){var k=e[y];if("string"==typeof k)g+=s(c(k));else{var _=s(c(k.prefix)),S=s(c(k.suffix));if(k.pattern){if(t&&t.push(k),_||S){if("+"===k.modifier||"*"===k.modifier){var T="*"===k.modifier?"?":"";g+="(?:".concat(_,"((?:").concat(k.pattern,")(?:").concat(S).concat(_,"(?:").concat(k.pattern,"))*)").concat(S,")").concat(T)}else g+="(?:".concat(_,"(").concat(k.pattern,")").concat(S,")").concat(k.modifier)}else{if("+"===k.modifier||"*"===k.modifier)throw TypeError('Can not repeat "'.concat(k.name,'" without a prefix and suffix'));g+="(".concat(k.pattern,")").concat(k.modifier)}}else g+="(?:".concat(_).concat(S,")").concat(k.modifier)}}if(void 0===o||o)n||(g+="".concat(m,"?")),g+=r.endsWith?"(?=".concat(p,")"):"$";else{var b=e[e.length-1],v="string"==typeof b?m.indexOf(b[b.length-1])>-1:void 0===b;n||(g+="(?:".concat(m,"(?=").concat(p,"))?")),v||(g+="(?=".concat(m,"|").concat(p,")"))}return new RegExp(g,D(r))}(function(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var i=e[r];if("*"===i||"+"===i||"?"===i){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if("\\"===i){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if("{"===i){t.push({type:"OPEN",index:r,value:e[r++]});continue}if("}"===i){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(":"===i){for(var n="",a=r+1;a<e.length;){var o=e.charCodeAt(a);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||95===o){n+=e[a++];continue}break}if(!n)throw TypeError("Missing parameter name at ".concat(r));t.push({type:"NAME",index:r,value:n}),r=a;continue}if("("===i){var l=1,c="",a=r+1;if("?"===e[a])throw TypeError('Pattern cannot start with "?" at '.concat(a));for(;a<e.length;){if("\\"===e[a]){c+=e[a++]+e[a++];continue}if(")"===e[a]){if(0==--l){a++;break}}else if("("===e[a]&&(l++,"?"!==e[a+1]))throw TypeError("Capturing groups are not allowed at ".concat(a));c+=e[a++]}if(l)throw TypeError("Unbalanced pattern at ".concat(r));if(!c)throw TypeError("Missing pattern at ".concat(r));t.push({type:"PATTERN",index:r,value:c}),r=a;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),i=t.prefixes,n=void 0===i?"./":i,a=t.delimiter,o=void 0===a?"/#?":a,l=[],c=0,u=0,h="",f=function(e){if(u<r.length&&r[u].type===e)return r[u++].value},w=function(e){var t=f(e);if(void 0!==t)return t;var i=r[u],n=i.type,a=i.index;throw TypeError("Unexpected ".concat(n," at ").concat(a,", expected ").concat(e))},d=function(){for(var e,t="";e=f("CHAR")||f("ESCAPED_CHAR");)t+=e;return t},M=function(e){for(var t=0;t<o.length;t++){var r=o[t];if(e.indexOf(r)>-1)return!0}return!1},A=function(e){var t=l[l.length-1],r=e||(t&&"string"==typeof t?t:"");if(t&&!r)throw TypeError('Must have text between two parameters, missing text after "'.concat(t.name,'"'));return!r||M(r)?"[^".concat(s(o),"]+?"):"(?:(?!".concat(s(r),")[^").concat(s(o),"])+?")};u<r.length;){var p=f("CHAR"),m=f("NAME"),g=f("PATTERN");if(m||g){var y=p||"";-1===n.indexOf(y)&&(h+=y,y=""),h&&(l.push(h),h=""),l.push({name:m||c++,prefix:y,suffix:"",pattern:g||A(y),modifier:f("MODIFIER")||""});continue}var k=p||f("ESCAPED_CHAR");if(k){h+=k;continue}if(h&&(l.push(h),h=""),f("OPEN")){var y=d(),_=f("NAME")||"",S=f("PATTERN")||"",T=d();w("CLOSE"),l.push({name:_||(S?c++:""),pattern:_&&!S?A(y):S,prefix:y,suffix:T,modifier:f("MODIFIER")||""});continue}w("END")}return l}(e,r),t,r)}(e,r,t),n=t,void 0===n&&(n={}),a=n.decode,o=void 0===a?function(e){return e}:a,function(e){var t=i.exec(e);if(!t)return!1;for(var n=t[0],a=t.index,l=Object.create(null),c=1;c<t.length;c++)!function(e){if(void 0!==t[e]){var i=r[e-1];"*"===i.modifier||"+"===i.modifier?l[i.name]=t[e].split(i.prefix+i.suffix).map(function(e){return o(e,i)}):l[i.name]=o(t[e],i)}}(c);return{path:n,index:a,params:l}}}catch(e){throw Error(`Invalid path and options: Consult the documentation of path-to-regexp here: https://github.com/pillarjs/path-to-regexp/tree/6.x
${e.message}`)}}var p="https://api.clerk.com",m="@clerk/backend@1.30.0",g="2025-04-10",y={Session:"__session",Refresh:"__refresh",ClientUat:"__client_uat",Handshake:"__clerk_handshake",DevBrowser:"__clerk_db_jwt",RedirectCount:"__clerk_redirect_count"},k={Attributes:{AuthToken:"__clerkAuthToken",AuthSignature:"__clerkAuthSignature",AuthStatus:"__clerkAuthStatus",AuthReason:"__clerkAuthReason",AuthMessage:"__clerkAuthMessage",ClerkUrl:"__clerkUrl"},Cookies:y,Headers:{Accept:"accept",AuthMessage:"x-clerk-auth-message",Authorization:"authorization",AuthReason:"x-clerk-auth-reason",AuthSignature:"x-clerk-auth-signature",AuthStatus:"x-clerk-auth-status",AuthToken:"x-clerk-auth-token",CacheControl:"cache-control",ClerkRedirectTo:"x-clerk-redirect-to",ClerkRequestData:"x-clerk-request-data",ClerkUrl:"x-clerk-clerk-url",CloudFrontForwardedProto:"cloudfront-forwarded-proto",ContentType:"content-type",ContentSecurityPolicy:"content-security-policy",ContentSecurityPolicyReportOnly:"content-security-policy-report-only",EnableDebug:"x-clerk-debug",ForwardedHost:"x-forwarded-host",ForwardedPort:"x-forwarded-port",ForwardedProto:"x-forwarded-proto",Host:"host",Location:"location",Nonce:"x-nonce",Origin:"origin",Referrer:"referer",SecFetchDest:"sec-fetch-dest",UserAgent:"user-agent",ReportingEndpoints:"reporting-endpoints"},ContentTypes:{Json:"application/json"},QueryParameters:{ClerkSynced:"__clerk_synced",SuffixedCookies:"suffixed_cookies",ClerkRedirectUrl:"__clerk_redirect_url",DevBrowser:y.DevBrowser,Handshake:y.Handshake,HandshakeHelp:"__clerk_help",LegacyDevBrowser:"__dev_session",HandshakeReason:"__clerk_hs_reason"}},_=RegExp("(?<!:)/{1,}","g");function joinPaths(...e){return e.filter(e=>e).join("/").replace(_,"/")}var S=class{constructor(e){this.request=e}requireId(e){if(!e)throw Error("A valid resource ID is required.")}},T="/actor_tokens",b=class extends S{async create(e){return this.request({method:"POST",path:T,bodyParams:e})}async revoke(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(T,e,"revoke")})}},v="/accountless_applications",I=class extends S{async createAccountlessApplication(){return this.request({method:"POST",path:v})}async completeAccountlessApplicationOnboarding(){return this.request({method:"POST",path:joinPaths(v,"complete")})}},O="/allowlist_identifiers",E=class extends S{async getAllowlistIdentifierList(e={}){return this.request({method:"GET",path:O,queryParams:{...e,paginated:!0}})}async createAllowlistIdentifier(e){return this.request({method:"POST",path:O,bodyParams:e})}async deleteAllowlistIdentifier(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(O,e)})}},x=class extends S{async changeDomain(e){return this.request({method:"POST",path:joinPaths("/beta_features","change_domain"),bodyParams:e})}},U="/blocklist_identifiers",q=class extends S{async getBlocklistIdentifierList(e={}){return this.request({method:"GET",path:U,queryParams:e})}async createBlocklistIdentifier(e){return this.request({method:"POST",path:U,bodyParams:e})}async deleteBlocklistIdentifier(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(U,e)})}},N="/clients",J=class extends S{async getClientList(e={}){return this.request({method:"GET",path:N,queryParams:{...e,paginated:!0}})}async getClient(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(N,e)})}verifyClient(e){return this.request({method:"POST",path:joinPaths(N,"verify"),bodyParams:{token:e}})}},j="/domains",R=class extends S{async list(){return this.request({method:"GET",path:j})}async add(e){return this.request({method:"POST",path:j,bodyParams:e})}async update(e){let{domainId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:joinPaths(j,t),bodyParams:r})}async delete(e){return this.deleteDomain(e)}async deleteDomain(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(j,e)})}},H="/email_addresses",z=class extends S{async getEmailAddress(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(H,e)})}async createEmailAddress(e){return this.request({method:"POST",path:H,bodyParams:e})}async updateEmailAddress(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(H,e),bodyParams:t})}async deleteEmailAddress(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(H,e)})}},K="/instance",W=class extends S{async get(){return this.request({method:"GET",path:K})}async update(e){return this.request({method:"PATCH",path:K,bodyParams:e})}async updateRestrictions(e){return this.request({method:"PATCH",path:joinPaths(K,"restrictions"),bodyParams:e})}async updateOrganizationSettings(e){return this.request({method:"PATCH",path:joinPaths(K,"organization_settings"),bodyParams:e})}},F="/invitations",L=class extends S{async getInvitationList(e={}){return this.request({method:"GET",path:F,queryParams:{...e,paginated:!0}})}async createInvitation(e){return this.request({method:"POST",path:F,bodyParams:e})}async revokeInvitation(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(F,e,"revoke")})}},B=class extends S{async getJwks(){return this.request({method:"GET",path:"/jwks"})}},$="/jwt_templates",G=class extends S{async list(e={}){return this.request({method:"GET",path:$,queryParams:{...e,paginated:!0}})}async get(e){return this.requireId(e),this.request({method:"GET",path:joinPaths($,e)})}async create(e){return this.request({method:"POST",path:$,bodyParams:e})}async update(e){let{templateId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:joinPaths($,t),bodyParams:r})}async delete(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths($,e)})}},Y="/organizations",V=class extends S{async getOrganizationList(e){return this.request({method:"GET",path:Y,queryParams:e})}async createOrganization(e){return this.request({method:"POST",path:Y,bodyParams:e})}async getOrganization(e){let{includeMembersCount:t}=e,r="organizationId"in e?e.organizationId:e.slug;return this.requireId(r),this.request({method:"GET",path:joinPaths(Y,r),queryParams:{includeMembersCount:t}})}async updateOrganization(e,t){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(Y,e),bodyParams:t})}async updateOrganizationLogo(e,t){this.requireId(e);let r=new n.GZ.FormData;return r.append("file",t?.file),t?.uploaderUserId&&r.append("uploader_user_id",t?.uploaderUserId),this.request({method:"PUT",path:joinPaths(Y,e,"logo"),formData:r})}async deleteOrganizationLogo(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(Y,e,"logo")})}async updateOrganizationMetadata(e,t){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(Y,e,"metadata"),bodyParams:t})}async deleteOrganization(e){return this.request({method:"DELETE",path:joinPaths(Y,e)})}async getOrganizationMembershipList(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:joinPaths(Y,t,"memberships"),queryParams:r})}async createOrganizationMembership(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:joinPaths(Y,t,"memberships"),bodyParams:r})}async updateOrganizationMembership(e){let{organizationId:t,userId:r,...i}=e;return this.requireId(t),this.request({method:"PATCH",path:joinPaths(Y,t,"memberships",r),bodyParams:i})}async updateOrganizationMembershipMetadata(e){let{organizationId:t,userId:r,...i}=e;return this.request({method:"PATCH",path:joinPaths(Y,t,"memberships",r,"metadata"),bodyParams:i})}async deleteOrganizationMembership(e){let{organizationId:t,userId:r}=e;return this.requireId(t),this.request({method:"DELETE",path:joinPaths(Y,t,"memberships",r)})}async getOrganizationInvitationList(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:joinPaths(Y,t,"invitations"),queryParams:r})}async createOrganizationInvitation(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:joinPaths(Y,t,"invitations"),bodyParams:r})}async getOrganizationInvitation(e){let{organizationId:t,invitationId:r}=e;return this.requireId(t),this.requireId(r),this.request({method:"GET",path:joinPaths(Y,t,"invitations",r)})}async revokeOrganizationInvitation(e){let{organizationId:t,invitationId:r,...i}=e;return this.requireId(t),this.request({method:"POST",path:joinPaths(Y,t,"invitations",r,"revoke"),bodyParams:i})}async getOrganizationDomainList(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:joinPaths(Y,t,"domains"),queryParams:r})}async createOrganizationDomain(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:joinPaths(Y,t,"domains"),bodyParams:{...r,verified:r.verified??!0}})}async updateOrganizationDomain(e){let{organizationId:t,domainId:r,...i}=e;return this.requireId(t),this.requireId(r),this.request({method:"PATCH",path:joinPaths(Y,t,"domains",r),bodyParams:i})}async deleteOrganizationDomain(e){let{organizationId:t,domainId:r}=e;return this.requireId(t),this.requireId(r),this.request({method:"DELETE",path:joinPaths(Y,t,"domains",r)})}},Q="/oauth_applications",Z=class extends S{async list(e={}){return this.request({method:"GET",path:Q,queryParams:e})}async get(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(Q,e)})}async create(e){return this.request({method:"POST",path:Q,bodyParams:e})}async update(e){let{oauthApplicationId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:joinPaths(Q,t),bodyParams:r})}async delete(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(Q,e)})}async rotateSecret(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(Q,e,"rotate_secret")})}},X="/phone_numbers",ee=class extends S{async getPhoneNumber(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(X,e)})}async createPhoneNumber(e){return this.request({method:"POST",path:X,bodyParams:e})}async updatePhoneNumber(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(X,e),bodyParams:t})}async deletePhoneNumber(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(X,e)})}},et=class extends S{async verify(e){return this.request({method:"POST",path:"/proxy_checks",bodyParams:e})}},er="/redirect_urls",ei=class extends S{async getRedirectUrlList(){return this.request({method:"GET",path:er,queryParams:{paginated:!0}})}async getRedirectUrl(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(er,e)})}async createRedirectUrl(e){return this.request({method:"POST",path:er,bodyParams:e})}async deleteRedirectUrl(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(er,e)})}},es="/saml_connections",en=class extends S{async getSamlConnectionList(e={}){return this.request({method:"GET",path:es,queryParams:e})}async createSamlConnection(e){return this.request({method:"POST",path:es,bodyParams:e})}async getSamlConnection(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(es,e)})}async updateSamlConnection(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(es,e),bodyParams:t})}async deleteSamlConnection(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(es,e)})}},ea="/sessions",eo=class extends S{async getSessionList(e={}){return this.request({method:"GET",path:ea,queryParams:{...e,paginated:!0}})}async getSession(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(ea,e)})}async createSession(e){return this.request({method:"POST",path:ea,bodyParams:e})}async revokeSession(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(ea,e,"revoke")})}async verifySession(e,t){return this.requireId(e),this.request({method:"POST",path:joinPaths(ea,e,"verify"),bodyParams:{token:t}})}async getToken(e,t){return this.requireId(e),this.request({method:"POST",path:joinPaths(ea,e,"tokens",t||"")})}async refreshSession(e,t){this.requireId(e);let{suffixed_cookies:r,...i}=t;return this.request({method:"POST",path:joinPaths(ea,e,"refresh"),bodyParams:i,queryParams:{suffixed_cookies:r}})}},el="/sign_in_tokens",ed=class extends S{async createSignInToken(e){return this.request({method:"POST",path:el,bodyParams:e})}async revokeSignInToken(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(el,e,"revoke")})}},ec="/sign_ups",eu=class extends S{async get(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(ec,e)})}async update(e){let{signUpAttemptId:t,...r}=e;return this.request({method:"PATCH",path:joinPaths(ec,t),bodyParams:r})}},eh=class extends S{async createTestingToken(){return this.request({method:"POST",path:"/testing_tokens"})}},ep="/users",em=class extends S{async getUserList(e={}){let{limit:t,offset:r,orderBy:i,...n}=e,[a,o]=await Promise.all([this.request({method:"GET",path:ep,queryParams:e}),this.getCount(n)]);return{data:a,totalCount:o}}async getUser(e){return this.requireId(e),this.request({method:"GET",path:joinPaths(ep,e)})}async createUser(e){return this.request({method:"POST",path:ep,bodyParams:e})}async updateUser(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(ep,e),bodyParams:t})}async updateUserProfileImage(e,t){this.requireId(e);let r=new n.GZ.FormData;return r.append("file",t?.file),this.request({method:"POST",path:joinPaths(ep,e,"profile_image"),formData:r})}async updateUserMetadata(e,t){return this.requireId(e),this.request({method:"PATCH",path:joinPaths(ep,e,"metadata"),bodyParams:t})}async deleteUser(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(ep,e)})}async getCount(e={}){return this.request({method:"GET",path:joinPaths(ep,"count"),queryParams:e})}async getUserOauthAccessToken(e,t){this.requireId(e);let r=t.startsWith("oauth_"),n=r?t:`oauth_${t}`;return r&&(0,i.x9)("getUserOauthAccessToken(userId, provider)","Remove the `oauth_` prefix from the `provider` argument."),this.request({method:"GET",path:joinPaths(ep,e,"oauth_access_tokens",n),queryParams:{paginated:!0}})}async disableUserMFA(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(ep,e,"mfa")})}async getOrganizationMembershipList(e){let{userId:t,limit:r,offset:i}=e;return this.requireId(t),this.request({method:"GET",path:joinPaths(ep,t,"organization_memberships"),queryParams:{limit:r,offset:i}})}async getOrganizationInvitationList(e){let{userId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:joinPaths(ep,t,"organization_invitations"),queryParams:r})}async verifyPassword(e){let{userId:t,password:r}=e;return this.requireId(t),this.request({method:"POST",path:joinPaths(ep,t,"verify_password"),bodyParams:{password:r}})}async verifyTOTP(e){let{userId:t,code:r}=e;return this.requireId(t),this.request({method:"POST",path:joinPaths(ep,t,"verify_totp"),bodyParams:{code:r}})}async banUser(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(ep,e,"ban")})}async unbanUser(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(ep,e,"unban")})}async lockUser(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(ep,e,"lock")})}async unlockUser(e){return this.requireId(e),this.request({method:"POST",path:joinPaths(ep,e,"unlock")})}async deleteUserProfileImage(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(ep,e,"profile_image")})}async deleteUserPasskey(e){return this.requireId(e.userId),this.requireId(e.passkeyIdentificationId),this.request({method:"DELETE",path:joinPaths(ep,e.userId,"passkeys",e.passkeyIdentificationId)})}async deleteUserWeb3Wallet(e){return this.requireId(e.userId),this.requireId(e.web3WalletIdentificationId),this.request({method:"DELETE",path:joinPaths(ep,e.userId,"web3_wallets",e.web3WalletIdentificationId)})}async deleteUserExternalAccount(e){return this.requireId(e.userId),this.requireId(e.externalAccountId),this.request({method:"DELETE",path:joinPaths(ep,e.userId,"external_accounts",e.externalAccountId)})}async deleteUserBackupCodes(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(ep,e,"backup_code")})}async deleteUserTOTP(e){return this.requireId(e),this.request({method:"DELETE",path:joinPaths(ep,e,"totp")})}},ef="/waitlist_entries",eg=class extends S{async list(e={}){return this.request({method:"GET",path:ef,queryParams:e})}async create(e){return this.request({method:"POST",path:ef,bodyParams:e})}},ey="/webhooks",ek=class extends S{async createSvixApp(){return this.request({method:"POST",path:joinPaths(ey,"svix")})}async generateSvixAuthURL(){return this.request({method:"POST",path:joinPaths(ey,"svix_url")})}async deleteSvixApp(){return this.request({method:"DELETE",path:joinPaths(ey,"svix")})}};function assertValidSecretKey(e){if(!e||"string"!=typeof e)throw Error("Missing Clerk Secret Key. Go to https://dashboard.clerk.com and get your key for your instance.")}var e_=class _ActorToken{constructor(e,t,r,i,n,a,o,l){this.id=e,this.status=t,this.userId=r,this.actor=i,this.token=n,this.url=a,this.createdAt=o,this.updatedAt=l}static fromJSON(e){return new _ActorToken(e.id,e.status,e.user_id,e.actor,e.token,e.url,e.created_at,e.updated_at)}},eS=class _AccountlessApplication{constructor(e,t,r,i){this.publishableKey=e,this.secretKey=t,this.claimUrl=r,this.apiKeysUrl=i}static fromJSON(e){return new _AccountlessApplication(e.publishable_key,e.secret_key,e.claim_url,e.api_keys_url)}},ew=class _AllowlistIdentifier{constructor(e,t,r,i,n,a,o){this.id=e,this.identifier=t,this.identifierType=r,this.createdAt=i,this.updatedAt=n,this.instanceId=a,this.invitationId=o}static fromJSON(e){return new _AllowlistIdentifier(e.id,e.identifier,e.identifier_type,e.created_at,e.updated_at,e.instance_id,e.invitation_id)}},eT=class _BlocklistIdentifier{constructor(e,t,r,i,n,a){this.id=e,this.identifier=t,this.identifierType=r,this.createdAt=i,this.updatedAt=n,this.instanceId=a}static fromJSON(e){return new _BlocklistIdentifier(e.id,e.identifier,e.identifier_type,e.created_at,e.updated_at,e.instance_id)}},eb=class _SessionActivity{constructor(e,t,r,i,n,a,o,l){this.id=e,this.isMobile=t,this.ipAddress=r,this.city=i,this.country=n,this.browserVersion=a,this.browserName=o,this.deviceType=l}static fromJSON(e){return new _SessionActivity(e.id,e.is_mobile,e.ip_address,e.city,e.country,e.browser_version,e.browser_name,e.device_type)}},ev=class _Session{constructor(e,t,r,i,n,a,o,l,c,u,h,p=null){this.id=e,this.clientId=t,this.userId=r,this.status=i,this.lastActiveAt=n,this.expireAt=a,this.abandonAt=o,this.createdAt=l,this.updatedAt=c,this.lastActiveOrganizationId=u,this.latestActivity=h,this.actor=p}static fromJSON(e){return new _Session(e.id,e.client_id,e.user_id,e.status,e.last_active_at,e.expire_at,e.abandon_at,e.created_at,e.updated_at,e.last_active_organization_id,e.latest_activity&&eb.fromJSON(e.latest_activity),e.actor)}},eA=class _Client{constructor(e,t,r,i,n,a,o,l){this.id=e,this.sessionIds=t,this.sessions=r,this.signInId=i,this.signUpId=n,this.lastActiveSessionId=a,this.createdAt=o,this.updatedAt=l}static fromJSON(e){return new _Client(e.id,e.session_ids,e.sessions.map(e=>ev.fromJSON(e)),e.sign_in_id,e.sign_up_id,e.last_active_session_id,e.created_at,e.updated_at)}},eI=class _CnameTarget{constructor(e,t,r){this.host=e,this.value=t,this.required=r}static fromJSON(e){return new _CnameTarget(e.host,e.value,e.required)}},eP=class _Cookies{constructor(e){this.cookies=e}static fromJSON(e){return new _Cookies(e.cookies)}},eC=class _DeletedObject{constructor(e,t,r,i){this.object=e,this.id=t,this.slug=r,this.deleted=i}static fromJSON(e){return new _DeletedObject(e.object,e.id||null,e.slug||null,e.deleted)}},eO=class _Domain{constructor(e,t,r,i,n,a,o,l){this.id=e,this.name=t,this.isSatellite=r,this.frontendApiUrl=i,this.developmentOrigin=n,this.cnameTargets=a,this.accountsPortalUrl=o,this.proxyUrl=l}static fromJSON(e){return new _Domain(e.id,e.name,e.is_satellite,e.frontend_api_url,e.development_origin,e.cname_targets&&e.cname_targets.map(e=>eI.fromJSON(e)),e.accounts_portal_url,e.proxy_url)}},eE=class _Email{constructor(e,t,r,i,n,a,o,l,c,u,h){this.id=e,this.fromEmailName=t,this.emailAddressId=r,this.toEmailAddress=i,this.subject=n,this.body=a,this.bodyPlain=o,this.status=l,this.slug=c,this.data=u,this.deliveredByClerk=h}static fromJSON(e){return new _Email(e.id,e.from_email_name,e.email_address_id,e.to_email_address,e.subject,e.body,e.body_plain,e.status,e.slug,e.data,e.delivered_by_clerk)}},ex=class _IdentificationLink{constructor(e,t){this.id=e,this.type=t}static fromJSON(e){return new _IdentificationLink(e.id,e.type)}},eU=class _Verification{constructor(e,t,r=null,i=null,n=null,a=null,o=null){this.status=e,this.strategy=t,this.externalVerificationRedirectURL=r,this.attempts=i,this.expireAt=n,this.nonce=a,this.message=o}static fromJSON(e){return new _Verification(e.status,e.strategy,e.external_verification_redirect_url?new URL(e.external_verification_redirect_url):null,e.attempts,e.expire_at,e.nonce)}},eq=class _EmailAddress{constructor(e,t,r,i){this.id=e,this.emailAddress=t,this.verification=r,this.linkedTo=i}static fromJSON(e){return new _EmailAddress(e.id,e.email_address,e.verification&&eU.fromJSON(e.verification),e.linked_to.map(e=>ex.fromJSON(e)))}},eN=class _ExternalAccount{constructor(e,t,r,i,n,a,o,l,c,u,h,p={},m,g){this.id=e,this.provider=t,this.identificationId=r,this.externalId=i,this.approvedScopes=n,this.emailAddress=a,this.firstName=o,this.lastName=l,this.imageUrl=c,this.username=u,this.phoneNumber=h,this.publicMetadata=p,this.label=m,this.verification=g}static fromJSON(e){return new _ExternalAccount(e.id,e.provider,e.identification_id,e.provider_user_id,e.approved_scopes,e.email_address,e.first_name,e.last_name,e.image_url||"",e.username,e.phone_number,e.public_metadata,e.label,e.verification&&eU.fromJSON(e.verification))}},eJ=class _Instance{constructor(e,t,r){this.id=e,this.environmentType=t,this.allowedOrigins=r}static fromJSON(e){return new _Instance(e.id,e.environment_type,e.allowed_origins)}},ej=class _InstanceRestrictions{constructor(e,t,r,i,n){this.allowlist=e,this.blocklist=t,this.blockEmailSubaddresses=r,this.blockDisposableEmailDomains=i,this.ignoreDotsForGmailAddresses=n}static fromJSON(e){return new _InstanceRestrictions(e.allowlist,e.blocklist,e.block_email_subaddresses,e.block_disposable_email_domains,e.ignore_dots_for_gmail_addresses)}},eR=class _InstanceSettings{constructor(e,t,r,i,n){this.id=e,this.restrictedToAllowlist=t,this.fromEmailAddress=r,this.progressiveSignUp=i,this.enhancedEmailDeliverability=n}static fromJSON(e){return new _InstanceSettings(e.id,e.restricted_to_allowlist,e.from_email_address,e.progressive_sign_up,e.enhanced_email_deliverability)}},eH=class _Invitation{constructor(e,t,r,i,n,a,o,l){this.id=e,this.emailAddress=t,this.publicMetadata=r,this.createdAt=i,this.updatedAt=n,this.status=a,this.url=o,this.revoked=l,this._raw=null}get raw(){return this._raw}static fromJSON(e){let t=new _Invitation(e.id,e.email_address,e.public_metadata,e.created_at,e.updated_at,e.status,e.url,e.revoked);return t._raw=e,t}},ez={AccountlessApplication:"accountless_application",ActorToken:"actor_token",AllowlistIdentifier:"allowlist_identifier",BlocklistIdentifier:"blocklist_identifier",Client:"client",Cookies:"cookies",Domain:"domain",Email:"email",EmailAddress:"email_address",Instance:"instance",InstanceRestrictions:"instance_restrictions",InstanceSettings:"instance_settings",Invitation:"invitation",JwtTemplate:"jwt_template",OauthAccessToken:"oauth_access_token",OAuthApplication:"oauth_application",Organization:"organization",OrganizationInvitation:"organization_invitation",OrganizationMembership:"organization_membership",OrganizationSettings:"organization_settings",PhoneNumber:"phone_number",ProxyCheck:"proxy_check",RedirectUrl:"redirect_url",Session:"session",SignInToken:"sign_in_token",SignUpAttempt:"sign_up_attempt",SmsMessage:"sms_message",User:"user",WaitlistEntry:"waitlist_entry",Token:"token",TotalCount:"total_count"},eD=class _JwtTemplate{constructor(e,t,r,i,n,a,o,l,c){this.id=e,this.name=t,this.claims=r,this.lifetime=i,this.allowedClockSkew=n,this.customSigningKey=a,this.signingAlgorithm=o,this.createdAt=l,this.updatedAt=c}static fromJSON(e){return new _JwtTemplate(e.id,e.name,e.claims,e.lifetime,e.allowed_clock_skew,e.custom_signing_key,e.signing_algorithm,e.created_at,e.updated_at)}},eM=class _OauthAccessToken{constructor(e,t,r,i={},n,a,o,l){this.externalAccountId=e,this.provider=t,this.token=r,this.publicMetadata=i,this.label=n,this.scopes=a,this.tokenSecret=o,this.expiresAt=l}static fromJSON(e){return new _OauthAccessToken(e.external_account_id,e.provider,e.token,e.public_metadata,e.label||"",e.scopes,e.token_secret,e.expires_at)}},eK=class _OAuthApplication{constructor(e,t,r,i,n,a,o,l,c,u,h,p,m,g,y){this.id=e,this.instanceId=t,this.name=r,this.clientId=i,this.isPublic=n,this.scopes=a,this.redirectUris=o,this.authorizeUrl=l,this.tokenFetchUrl=c,this.userInfoUrl=u,this.discoveryUrl=h,this.tokenIntrospectionUrl=p,this.createdAt=m,this.updatedAt=g,this.clientSecret=y}static fromJSON(e){return new _OAuthApplication(e.id,e.instance_id,e.name,e.client_id,e.public,e.scopes,e.redirect_uris,e.authorize_url,e.token_fetch_url,e.user_info_url,e.discovery_url,e.token_introspection_url,e.created_at,e.updated_at,e.client_secret)}},eW=class _Organization{constructor(e,t,r,i,n,a,o,l={},c={},u,h,p,m){this.id=e,this.name=t,this.slug=r,this.imageUrl=i,this.hasImage=n,this.createdAt=a,this.updatedAt=o,this.publicMetadata=l,this.privateMetadata=c,this.maxAllowedMemberships=u,this.adminDeleteEnabled=h,this.membersCount=p,this.createdBy=m,this._raw=null}get raw(){return this._raw}static fromJSON(e){let t=new _Organization(e.id,e.name,e.slug,e.image_url||"",e.has_image,e.created_at,e.updated_at,e.public_metadata,e.private_metadata,e.max_allowed_memberships,e.admin_delete_enabled,e.members_count,e.created_by);return t._raw=e,t}},eF=class _OrganizationInvitation{constructor(e,t,r,i,n,a,o,l,c,u,h={},p={},m){this.id=e,this.emailAddress=t,this.role=r,this.roleName=i,this.organizationId=n,this.createdAt=a,this.updatedAt=o,this.expiresAt=l,this.url=c,this.status=u,this.publicMetadata=h,this.privateMetadata=p,this.publicOrganizationData=m,this._raw=null}get raw(){return this._raw}static fromJSON(e){let t=new _OrganizationInvitation(e.id,e.email_address,e.role,e.role_name,e.organization_id,e.created_at,e.updated_at,e.expires_at,e.url,e.status,e.public_metadata,e.private_metadata,e.public_organization_data);return t._raw=e,t}},eL=class _OrganizationMembership{constructor(e,t,r,i={},n={},a,o,l,c){this.id=e,this.role=t,this.permissions=r,this.publicMetadata=i,this.privateMetadata=n,this.createdAt=a,this.updatedAt=o,this.organization=l,this.publicUserData=c,this._raw=null}get raw(){return this._raw}static fromJSON(e){let t=new _OrganizationMembership(e.id,e.role,e.permissions,e.public_metadata,e.private_metadata,e.created_at,e.updated_at,eW.fromJSON(e.organization),eB.fromJSON(e.public_user_data));return t._raw=e,t}},eB=class _OrganizationMembershipPublicUserData{constructor(e,t,r,i,n,a){this.identifier=e,this.firstName=t,this.lastName=r,this.imageUrl=i,this.hasImage=n,this.userId=a}static fromJSON(e){return new _OrganizationMembershipPublicUserData(e.identifier,e.first_name,e.last_name,e.image_url,e.has_image,e.user_id)}},e$=class _OrganizationSettings{constructor(e,t,r,i,n,a,o,l,c){this.enabled=e,this.maxAllowedMemberships=t,this.maxAllowedRoles=r,this.maxAllowedPermissions=i,this.creatorRole=n,this.adminDeleteEnabled=a,this.domainsEnabled=o,this.domainsEnrollmentModes=l,this.domainsDefaultRole=c}static fromJSON(e){return new _OrganizationSettings(e.enabled,e.max_allowed_memberships,e.max_allowed_roles,e.max_allowed_permissions,e.creator_role,e.admin_delete_enabled,e.domains_enabled,e.domains_enrollment_modes,e.domains_default_role)}},eG=class _PhoneNumber{constructor(e,t,r,i,n,a){this.id=e,this.phoneNumber=t,this.reservedForSecondFactor=r,this.defaultSecondFactor=i,this.verification=n,this.linkedTo=a}static fromJSON(e){return new _PhoneNumber(e.id,e.phone_number,e.reserved_for_second_factor,e.default_second_factor,e.verification&&eU.fromJSON(e.verification),e.linked_to.map(e=>ex.fromJSON(e)))}},eY=class _ProxyCheck{constructor(e,t,r,i,n,a,o){this.id=e,this.domainId=t,this.lastRunAt=r,this.proxyUrl=i,this.successful=n,this.createdAt=a,this.updatedAt=o}static fromJSON(e){return new _ProxyCheck(e.id,e.domain_id,e.last_run_at,e.proxy_url,e.successful,e.created_at,e.updated_at)}},eV=class _RedirectUrl{constructor(e,t,r,i){this.id=e,this.url=t,this.createdAt=r,this.updatedAt=i}static fromJSON(e){return new _RedirectUrl(e.id,e.url,e.created_at,e.updated_at)}},eQ=class _SignInToken{constructor(e,t,r,i,n,a,o){this.id=e,this.userId=t,this.token=r,this.status=i,this.url=n,this.createdAt=a,this.updatedAt=o}static fromJSON(e){return new _SignInToken(e.id,e.user_id,e.token,e.status,e.url,e.created_at,e.updated_at)}},eZ=class _SignUpAttemptVerification{constructor(e,t){this.nextAction=e,this.supportedStrategies=t}static fromJSON(e){return new _SignUpAttemptVerification(e.next_action,e.supported_strategies)}},eX=class _SignUpAttemptVerifications{constructor(e,t,r,i){this.emailAddress=e,this.phoneNumber=t,this.web3Wallet=r,this.externalAccount=i}static fromJSON(e){return new _SignUpAttemptVerifications(e.email_address&&eZ.fromJSON(e.email_address),e.phone_number&&eZ.fromJSON(e.phone_number),e.web3_wallet&&eZ.fromJSON(e.web3_wallet),e.external_account)}},e0=class _SignUpAttempt{constructor(e,t,r,i,n,a,o,l,c,u,h,p,m,g,y,k,_,S,T,b,v,I){this.id=e,this.status=t,this.requiredFields=r,this.optionalFields=i,this.missingFields=n,this.unverifiedFields=a,this.verifications=o,this.username=l,this.emailAddress=c,this.phoneNumber=u,this.web3Wallet=h,this.passwordEnabled=p,this.firstName=m,this.lastName=g,this.customAction=y,this.externalId=k,this.createdSessionId=_,this.createdUserId=S,this.abandonAt=T,this.legalAcceptedAt=b,this.publicMetadata=v,this.unsafeMetadata=I}static fromJSON(e){return new _SignUpAttempt(e.id,e.status,e.required_fields,e.optional_fields,e.missing_fields,e.unverified_fields,e.verifications?eX.fromJSON(e.verifications):null,e.username,e.email_address,e.phone_number,e.web3_wallet,e.password_enabled,e.first_name,e.last_name,e.custom_action,e.external_id,e.created_session_id,e.created_user_id,e.abandon_at,e.legal_accepted_at,e.public_metadata,e.unsafe_metadata)}},e1=class _SMSMessage{constructor(e,t,r,i,n,a,o){this.id=e,this.fromPhoneNumber=t,this.toPhoneNumber=r,this.message=i,this.status=n,this.phoneNumberId=a,this.data=o}static fromJSON(e){return new _SMSMessage(e.id,e.from_phone_number,e.to_phone_number,e.message,e.status,e.phone_number_id,e.data)}},e2=class _Token{constructor(e){this.jwt=e}static fromJSON(e){return new _Token(e.jwt)}},e5=class _SamlAccountConnection{constructor(e,t,r,i,n,a,o,l,c,u){this.id=e,this.name=t,this.domain=r,this.active=i,this.provider=n,this.syncUserAttributes=a,this.allowSubdomains=o,this.allowIdpInitiated=l,this.createdAt=c,this.updatedAt=u}static fromJSON(e){return new _SamlAccountConnection(e.id,e.name,e.domain,e.active,e.provider,e.sync_user_attributes,e.allow_subdomains,e.allow_idp_initiated,e.created_at,e.updated_at)}},e3=class _SamlAccount{constructor(e,t,r,i,n,a,o,l,c){this.id=e,this.provider=t,this.providerUserId=r,this.active=i,this.emailAddress=n,this.firstName=a,this.lastName=o,this.verification=l,this.samlConnection=c}static fromJSON(e){return new _SamlAccount(e.id,e.provider,e.provider_user_id,e.active,e.email_address,e.first_name,e.last_name,e.verification&&eU.fromJSON(e.verification),e.saml_connection&&e5.fromJSON(e.saml_connection))}},e8=class _Web3Wallet{constructor(e,t,r){this.id=e,this.web3Wallet=t,this.verification=r}static fromJSON(e){return new _Web3Wallet(e.id,e.web3_wallet,e.verification&&eU.fromJSON(e.verification))}},e9=class _User{constructor(e,t,r,i,n,a,o,l,c,u,h,p,m,g,y,k,_,S,T,b={},v={},I={},O=[],E=[],x=[],U=[],q=[],N,J,j=null,R,H){this.id=e,this.passwordEnabled=t,this.totpEnabled=r,this.backupCodeEnabled=i,this.twoFactorEnabled=n,this.banned=a,this.locked=o,this.createdAt=l,this.updatedAt=c,this.imageUrl=u,this.hasImage=h,this.primaryEmailAddressId=p,this.primaryPhoneNumberId=m,this.primaryWeb3WalletId=g,this.lastSignInAt=y,this.externalId=k,this.username=_,this.firstName=S,this.lastName=T,this.publicMetadata=b,this.privateMetadata=v,this.unsafeMetadata=I,this.emailAddresses=O,this.phoneNumbers=E,this.web3Wallets=x,this.externalAccounts=U,this.samlAccounts=q,this.lastActiveAt=N,this.createOrganizationEnabled=J,this.createOrganizationsLimit=j,this.deleteSelfEnabled=R,this.legalAcceptedAt=H,this._raw=null}get raw(){return this._raw}static fromJSON(e){let t=new _User(e.id,e.password_enabled,e.totp_enabled,e.backup_code_enabled,e.two_factor_enabled,e.banned,e.locked,e.created_at,e.updated_at,e.image_url,e.has_image,e.primary_email_address_id,e.primary_phone_number_id,e.primary_web3_wallet_id,e.last_sign_in_at,e.external_id,e.username,e.first_name,e.last_name,e.public_metadata,e.private_metadata,e.unsafe_metadata,(e.email_addresses||[]).map(e=>eq.fromJSON(e)),(e.phone_numbers||[]).map(e=>eG.fromJSON(e)),(e.web3_wallets||[]).map(e=>e8.fromJSON(e)),(e.external_accounts||[]).map(e=>eN.fromJSON(e)),(e.saml_accounts||[]).map(e=>e3.fromJSON(e)),e.last_active_at,e.create_organization_enabled,e.create_organizations_limit,e.delete_self_enabled,e.legal_accepted_at);return t._raw=e,t}get primaryEmailAddress(){return this.emailAddresses.find(({id:e})=>e===this.primaryEmailAddressId)??null}get primaryPhoneNumber(){return this.phoneNumbers.find(({id:e})=>e===this.primaryPhoneNumberId)??null}get primaryWeb3Wallet(){return this.web3Wallets.find(({id:e})=>e===this.primaryWeb3WalletId)??null}get fullName(){return[this.firstName,this.lastName].join(" ").trim()||null}},e6=class _WaitlistEntry{constructor(e,t,r,i,n,a,o){this.id=e,this.emailAddress=t,this.status=r,this.invitation=i,this.createdAt=n,this.updatedAt=a,this.isLocked=o}static fromJSON(e){return new _WaitlistEntry(e.id,e.email_address,e.status,e.invitation&&eH.fromJSON(e.invitation),e.created_at,e.updated_at,e.is_locked)}};function jsonToObject(e){if("string"!=typeof e&&"object"in e&&"deleted"in e)return eC.fromJSON(e);switch(e.object){case ez.AccountlessApplication:return eS.fromJSON(e);case ez.ActorToken:return e_.fromJSON(e);case ez.AllowlistIdentifier:return ew.fromJSON(e);case ez.BlocklistIdentifier:return eT.fromJSON(e);case ez.Client:return eA.fromJSON(e);case ez.Cookies:return eP.fromJSON(e);case ez.Domain:return eO.fromJSON(e);case ez.EmailAddress:return eq.fromJSON(e);case ez.Email:return eE.fromJSON(e);case ez.Instance:return eJ.fromJSON(e);case ez.InstanceRestrictions:return ej.fromJSON(e);case ez.InstanceSettings:return eR.fromJSON(e);case ez.Invitation:return eH.fromJSON(e);case ez.JwtTemplate:return eD.fromJSON(e);case ez.OauthAccessToken:return eM.fromJSON(e);case ez.OAuthApplication:return eK.fromJSON(e);case ez.Organization:return eW.fromJSON(e);case ez.OrganizationInvitation:return eF.fromJSON(e);case ez.OrganizationMembership:return eL.fromJSON(e);case ez.OrganizationSettings:return e$.fromJSON(e);case ez.PhoneNumber:return eG.fromJSON(e);case ez.ProxyCheck:return eY.fromJSON(e);case ez.RedirectUrl:return eV.fromJSON(e);case ez.SignInToken:return eQ.fromJSON(e);case ez.SignUpAttempt:return e0.fromJSON(e);case ez.Session:return ev.fromJSON(e);case ez.SmsMessage:return e1.fromJSON(e);case ez.Token:return e2.fromJSON(e);case ez.TotalCount:return e.total_count;case ez.User:return e9.fromJSON(e);case ez.WaitlistEntry:return e6.fromJSON(e);default:return e}}function buildRequest(e){let requestFn=async t=>{let r;let{secretKey:i,requireSecretKey:a=!0,apiUrl:o=p,apiVersion:c="v1",userAgent:u=m}=e,{path:h,method:y,queryParams:_,headerParams:S,bodyParams:T,formData:b}=t;a&&assertValidSecretKey(i);let v=joinPaths(o,c,h),I=new URL(v);if(_){let e=l({..._});for(let[t,r]of Object.entries(e))r&&[r].flat().forEach(e=>I.searchParams.append(t,e))}let O={"Clerk-API-Version":g,"User-Agent":u,...S};i&&(O.Authorization=`Bearer ${i}`);try{if(b)r=await n.GZ.fetch(I.href,{method:y,headers:O,body:b});else{O["Content-Type"]="application/json";let e="GET"!==y&&T&&Object.keys(T).length>0,t=e?{body:JSON.stringify(l(T,{deep:!1}))}:null;r=await n.GZ.fetch(I.href,{method:y,headers:O,...t})}let e=r?.headers&&r.headers?.get(k.Headers.ContentType)===k.ContentTypes.Json,t=await (e?r.json():r.text());if(!r.ok)return{data:null,errors:parseErrors(t),status:r?.status,statusText:r?.statusText,clerkTraceId:getTraceId(t,r?.headers),retryAfter:getRetryAfter(r?.headers)};return{...function(e){if(Array.isArray(e)){let t=e.map(e=>jsonToObject(e));return{data:t}}return e&&"object"==typeof e&&"data"in e&&Array.isArray(e.data)&&void 0!==e.data?{data:e.data.map(e=>jsonToObject(e)),totalCount:e.total_count}:{data:jsonToObject(e)}}(t),errors:null}}catch(e){if(e instanceof Error)return{data:null,errors:[{code:"unexpected_error",message:e.message||"Unexpected error"}],clerkTraceId:getTraceId(e,r?.headers)};return{data:null,errors:parseErrors(e),status:r?.status,statusText:r?.statusText,clerkTraceId:getTraceId(e,r?.headers),retryAfter:getRetryAfter(r?.headers)}}};return async(...e)=>{let{data:t,errors:r,totalCount:i,status:n,statusText:a,clerkTraceId:l,retryAfter:c}=await requestFn(...e);if(r){let e=new o.gO(a||"",{data:[],status:n,clerkTraceId:l,retryAfter:c});throw e.errors=r,e}return void 0!==i?{data:t,totalCount:i}:t}}function getTraceId(e,t){if(e&&"object"==typeof e&&"clerk_trace_id"in e&&"string"==typeof e.clerk_trace_id)return e.clerk_trace_id;let r=t?.get("cf-ray");return r||""}function getRetryAfter(e){let t=e?.get("Retry-After");if(!t)return;let r=parseInt(t,10);if(!isNaN(r))return r}function parseErrors(e){if(e&&"object"==typeof e&&"errors"in e){let t=e.errors;return t.length>0?t.map(o.nU):[]}return[]}function createBackendApiClient(e){let t=buildRequest(e);return{__experimental_accountlessApplications:new I(buildRequest({...e,requireSecretKey:!1})),actorTokens:new b(t),allowlistIdentifiers:new E(t),betaFeatures:new x(t),blocklistIdentifiers:new q(t),clients:new J(t),domains:new R(t),emailAddresses:new z(t),instance:new W(t),invitations:new L(t),jwks:new B(t),jwtTemplates:new G(t),oauthApplications:new Z(t),organizations:new V(t),phoneNumbers:new ee(t),proxyChecks:new et(t),redirectUrls:new ei(t),samlConnections:new en(t),sessions:new eo(t),signInTokens:new ed(t),signUps:new eu(t),testingTokens:new eh(t),users:new em(t),waitlistEntries:new eg(t),webhooks:new ek(t)}}var createDebug=e=>()=>{let t={...e};return t.secretKey=(t.secretKey||"").substring(0,7),t.jwtKey=(t.jwtKey||"").substring(0,7),{...t}},createGetToken=e=>{let{fetcher:t,sessionToken:r,sessionId:i}=e||{};return async(e={})=>i?e.template?t(i,e.template):r:null},e7={SignedIn:"signed-in",SignedOut:"signed-out",Handshake:"handshake"},e4={ClientUATWithoutSessionToken:"client-uat-but-no-session-token",DevBrowserMissing:"dev-browser-missing",DevBrowserSync:"dev-browser-sync",PrimaryRespondsToSyncing:"primary-responds-to-syncing",SatelliteCookieNeedsSyncing:"satellite-needs-syncing",SessionTokenAndUATMissing:"session-token-and-uat-missing",SessionTokenMissing:"session-token-missing",SessionTokenExpired:"session-token-expired",SessionTokenIATBeforeClientUAT:"session-token-iat-before-client-uat",SessionTokenNBF:"session-token-nbf",SessionTokenIatInTheFuture:"session-token-iat-in-the-future",SessionTokenWithoutClientUAT:"session-token-but-no-client-uat",ActiveOrganizationMismatch:"active-organization-mismatch",UnexpectedError:"unexpected-error"};function signedIn(e,t,r=new Headers,i){let n=function(e,t,r){let{actor:i,sessionId:n,sessionStatus:a,userId:o,orgId:l,orgRole:u,orgSlug:h,orgPermissions:p,factorVerificationAge:m}=__experimental_JWTPayloadToAuthObjectProperties(r),g=createBackendApiClient(e),y=createGetToken({sessionId:n,sessionToken:t,fetcher:async(...e)=>(await g.sessions.getToken(...e)).jwt});return{actor:i,sessionClaims:r,sessionId:n,sessionStatus:a,userId:o,orgId:l,orgRole:u,orgSlug:h,orgPermissions:p,factorVerificationAge:m,getToken:y,has:(0,c.QL)({orgId:l,orgRole:u,orgPermissions:p,userId:o,factorVerificationAge:m,features:r.fea||"",plans:r.pla||""}),debug:createDebug({...e,sessionToken:t})}}(e,i,t);return{status:e7.SignedIn,reason:null,message:null,proxyUrl:e.proxyUrl||"",publishableKey:e.publishableKey||"",isSatellite:e.isSatellite||!1,domain:e.domain||"",signInUrl:e.signInUrl||"",signUpUrl:e.signUpUrl||"",afterSignInUrl:e.afterSignInUrl||"",afterSignUpUrl:e.afterSignUpUrl||"",isSignedIn:!0,toAuth:()=>n,headers:r,token:i}}function signedOut(e,t,r="",i=new Headers){return withDebugHeaders({status:e7.SignedOut,reason:t,message:r,proxyUrl:e.proxyUrl||"",publishableKey:e.publishableKey||"",isSatellite:e.isSatellite||!1,domain:e.domain||"",signInUrl:e.signInUrl||"",signUpUrl:e.signUpUrl||"",afterSignInUrl:e.afterSignInUrl||"",afterSignUpUrl:e.afterSignUpUrl||"",isSignedIn:!1,headers:i,toAuth:()=>({sessionClaims:null,sessionId:null,sessionStatus:null,userId:null,actor:null,orgId:null,orgRole:null,orgSlug:null,orgPermissions:null,factorVerificationAge:null,getToken:()=>Promise.resolve(null),has:()=>!1,debug:createDebug({...e,status:e7.SignedOut,reason:t,message:r})}),token:null})}var withDebugHeaders=e=>{let t=new Headers(e.headers||{});if(e.message)try{t.set(k.Headers.AuthMessage,e.message)}catch{}if(e.reason)try{t.set(k.Headers.AuthReason,e.reason)}catch{}if(e.status)try{t.set(k.Headers.AuthStatus,e.status)}catch{}return e.headers=t,e},te=class extends URL{isCrossOrigin(e){return this.origin!==new URL(e.toString()).origin}},createClerkUrl=(...e)=>new te(...e),tt=class extends Request{constructor(e,t){let r="string"!=typeof e&&"url"in e?e.url:String(e);super(r,t||"string"==typeof e?void 0:e),this.clerkUrl=this.deriveUrlFromHeaders(this),this.cookies=this.parseCookies(this)}toJSON(){return{url:this.clerkUrl.href,method:this.method,headers:JSON.stringify(Object.fromEntries(this.headers)),clerkUrl:this.clerkUrl.toString(),cookies:JSON.stringify(Object.fromEntries(this.cookies))}}deriveUrlFromHeaders(e){let t=new URL(e.url),r=e.headers.get(k.Headers.ForwardedProto),i=e.headers.get(k.Headers.ForwardedHost),n=e.headers.get(k.Headers.Host),a=t.protocol,o=this.getFirstValueFromHeader(i)??n,l=this.getFirstValueFromHeader(r)??a?.replace(/[:/]/,""),c=o&&l?`${l}://${o}`:t.origin;return c===t.origin?createClerkUrl(t):createClerkUrl(t.pathname+t.search,c)}getFirstValueFromHeader(e){return e?.split(",")[0]}parseCookies(e){let t=(0,h.Qc)(this.decodeCookieValue(e.headers.get("cookie")||""));return new Map(Object.entries(t))}decodeCookieValue(e){return e?e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent):e}},createClerkRequest=(...e)=>e[0]instanceof tt?e[0]:new tt(...e),tr={},ti=0;function setInCache(e,t=!0){tr[e.kid]=e,ti=t?Date.now():-1}var ts="local";function loadClerkJWKFromLocal(e){if(!tr[ts]){if(!e)throw new a.oh({action:a.h2.SetClerkJWTKey,message:"Missing local JWK.",reason:a.YU.LocalJWKMissing});let t=e.replace(/\r\n|\n|\r/g,"").replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace("MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA","").replace("IDAQAB","").replace(/\+/g,"-").replace(/\//g,"_");setInCache({kid:"local",kty:"RSA",alg:"RS256",n:t,e:"AQAB"},!1)}return tr[ts]}async function loadClerkJWKFromRemote({secretKey:e,apiUrl:t=p,apiVersion:r="v1",kid:n,skipJwksCache:o}){if(o||function(){if(-1===ti)return!1;let e=Date.now()-ti>=3e5;return e&&(tr={}),e}()||!tr[n]){if(!e)throw new a.oh({action:a.h2.ContactSupport,message:"Failed to load JWKS from Clerk Backend or Frontend API.",reason:a.YU.RemoteJWKFailedToLoad});let{keys:n}=await (0,i.XD)(()=>fetchJWKSFromBAPI(t,e,r));if(!n||!n.length)throw new a.oh({action:a.h2.ContactSupport,message:"The JWKS endpoint did not contain any signing keys. Contact support@clerk.com.",reason:a.YU.RemoteJWKFailedToLoad});n.forEach(e=>setInCache(e))}let l=tr[n];if(!l){let e=Object.values(tr),t=e.map(e=>e.kid).sort().join(", ");throw new a.oh({action:`Go to your Dashboard and validate your secret and public keys are correct. ${a.h2.ContactSupport} if the issue persists.`,message:`Unable to find a signing key in JWKS that matches the kid='${n}' of the provided session token. Please make sure that the __session cookie or the HTTP authorization header contain a Clerk-generated session JWT. The following kid is available: ${t}`,reason:a.YU.JWKKidMismatch})}return l}async function fetchJWKSFromBAPI(e,t,r){if(!t)throw new a.oh({action:a.h2.SetClerkSecretKey,message:"Missing Clerk Secret Key or API Key. Go to https://dashboard.clerk.com and get your key for your instance.",reason:a.YU.RemoteJWKFailedToLoad});let i=new URL(e);i.pathname=joinPaths(i.pathname,r,"/jwks");let o=await n.GZ.fetch(i.href,{headers:{Authorization:`Bearer ${t}`,"Clerk-API-Version":g,"Content-Type":"application/json","User-Agent":m}});if(!o.ok){let e=await o.json(),t=getErrorObjectByCode(e?.errors,a.rE.InvalidSecretKey);if(t){let e=a.YU.InvalidSecretKey;throw new a.oh({action:a.h2.ContactSupport,message:t.message,reason:e})}throw new a.oh({action:a.h2.ContactSupport,message:`Error loading Clerk JWKS from ${i.href} with code=${o.status}`,reason:a.YU.RemoteJWKFailedToLoad})}return o.json()}var getErrorObjectByCode=(e,t)=>e?e.find(e=>e.code===t):null;async function verifyToken(e,t){let{data:r,errors:i}=(0,n.t5)(e);if(i)return{errors:i};let{header:o}=r,{kid:l}=o;try{let r;if(t.jwtKey)r=loadClerkJWKFromLocal(t.jwtKey);else{if(!t.secretKey)return{errors:[new a.oh({action:a.h2.SetClerkJWTKey,message:"Failed to resolve JWK during verification.",reason:a.YU.JWKFailedToResolve})]};r=await loadClerkJWKFromRemote({...t,kid:l})}return await (0,n.$v)(e,{...t,key:r})}catch(e){return{errors:[e]}}}var tn=class{constructor(e,t,r){this.cookieSuffix=e,this.clerkRequest=t,this.initPublishableKeyValues(r),this.initHeaderValues(),this.initCookieValues(),this.initHandshakeValues(),Object.assign(this,r),this.clerkUrl=this.clerkRequest.clerkUrl}get sessionToken(){return this.sessionTokenInCookie||this.sessionTokenInHeader}usesSuffixedCookies(){let e=this.getSuffixedCookie(k.Cookies.ClientUat),t=this.getCookie(k.Cookies.ClientUat),r=this.getSuffixedCookie(k.Cookies.Session)||"",i=this.getCookie(k.Cookies.Session)||"";if(i&&!this.tokenHasIssuer(i))return!1;if(i&&!this.tokenBelongsToInstance(i))return!0;if(!e&&!r)return!1;let{data:a}=(0,n.t5)(i),o=a?.payload.iat||0,{data:l}=(0,n.t5)(r),c=l?.payload.iat||0;if("0"!==e&&"0"!==t&&o>c||"0"===e&&"0"!==t)return!1;if("production"!==this.instanceType){let r=this.sessionExpired(l);if("0"!==e&&"0"===t&&r)return!1}return!!e||!r}initPublishableKeyValues(e){var t;t=e.publishableKey,(0,i.nQ)(t,{fatal:!0}),this.publishableKey=e.publishableKey;let r=(0,i.nQ)(this.publishableKey,{fatal:!0,proxyUrl:e.proxyUrl,domain:e.domain});this.instanceType=r.instanceType,this.frontendApi=r.frontendApi}initHeaderValues(){this.sessionTokenInHeader=this.parseAuthorizationHeader(this.getHeader(k.Headers.Authorization)),this.origin=this.getHeader(k.Headers.Origin),this.host=this.getHeader(k.Headers.Host),this.forwardedHost=this.getHeader(k.Headers.ForwardedHost),this.forwardedProto=this.getHeader(k.Headers.CloudFrontForwardedProto)||this.getHeader(k.Headers.ForwardedProto),this.referrer=this.getHeader(k.Headers.Referrer),this.userAgent=this.getHeader(k.Headers.UserAgent),this.secFetchDest=this.getHeader(k.Headers.SecFetchDest),this.accept=this.getHeader(k.Headers.Accept)}initCookieValues(){this.sessionTokenInCookie=this.getSuffixedOrUnSuffixedCookie(k.Cookies.Session),this.refreshTokenInCookie=this.getSuffixedCookie(k.Cookies.Refresh),this.clientUat=Number.parseInt(this.getSuffixedOrUnSuffixedCookie(k.Cookies.ClientUat)||"")||0}initHandshakeValues(){this.devBrowserToken=this.getQueryParam(k.QueryParameters.DevBrowser)||this.getSuffixedOrUnSuffixedCookie(k.Cookies.DevBrowser),this.handshakeToken=this.getQueryParam(k.QueryParameters.Handshake)||this.getCookie(k.Cookies.Handshake),this.handshakeRedirectLoopCounter=Number(this.getCookie(k.Cookies.RedirectCount))||0}getQueryParam(e){return this.clerkRequest.clerkUrl.searchParams.get(e)}getHeader(e){return this.clerkRequest.headers.get(e)||void 0}getCookie(e){return this.clerkRequest.cookies.get(e)||void 0}getSuffixedCookie(e){return this.getCookie((0,i._d)(e,this.cookieSuffix))||void 0}getSuffixedOrUnSuffixedCookie(e){return this.usesSuffixedCookies()?this.getSuffixedCookie(e):this.getCookie(e)}parseAuthorizationHeader(e){if(!e)return;let[t,r]=e.split(" ",2);return r?"Bearer"===t?r:void 0:t}tokenHasIssuer(e){let{data:t,errors:r}=(0,n.t5)(e);return!r&&!!t.payload.iss}tokenBelongsToInstance(e){if(!e)return!1;let{data:t,errors:r}=(0,n.t5)(e);if(r)return!1;let i=t.payload.iss.replace(/https?:\/\//gi,"");return this.frontendApi===i}sessionExpired(e){return!!e&&e?.payload.exp<=Date.now()/1e3>>0}},createAuthenticateContext=async(e,t)=>{let r=t.publishableKey?await (0,i.P)(t.publishableKey,n.GZ.crypto.subtle):"";return new tn(r,e,t)},getCookieName=e=>e.split(";")[0]?.split("=")[0],getCookieValue=e=>e.split(";")[0]?.split("=")[1];async function verifyHandshakeJwt(e,{key:t}){let{data:r,errors:i}=(0,n.t5)(e);if(i)throw i[0];let{header:o,payload:l}=r,{typ:c,alg:u}=o;(0,n.jl)(c),(0,n.l_)(u);let{data:h,errors:p}=await (0,n.N7)(r,t);if(p)throw new a.oh({reason:a.YU.TokenVerificationFailed,message:`Error verifying handshake token. ${p[0]}`});if(!h)throw new a.oh({reason:a.YU.TokenInvalidSignature,message:"Handshake signature is invalid."});return l}async function verifyHandshakeToken(e,t){let r;let{secretKey:i,apiUrl:o,apiVersion:l,jwksCacheTtlInMs:c,jwtKey:u,skipJwksCache:h}=t,{data:p,errors:m}=(0,n.t5)(e);if(m)throw m[0];let{kid:g}=p.header;if(u)r=loadClerkJWKFromLocal(u);else if(i)r=await loadClerkJWKFromRemote({secretKey:i,apiUrl:o,apiVersion:l,kid:g,jwksCacheTtlInMs:c,skipJwksCache:h});else throw new a.oh({action:a.h2.SetClerkJWTKey,message:"Failed to resolve JWK during handshake verification.",reason:a.YU.JWKFailedToResolve});return await verifyHandshakeJwt(e,{key:r})}var ta={NonEligibleNoCookie:"non-eligible-no-refresh-cookie",NonEligibleNonGet:"non-eligible-non-get",InvalidSessionToken:"invalid-session-token",MissingApiClient:"missing-api-client",MissingSessionToken:"missing-session-token",MissingRefreshToken:"missing-refresh-token",ExpiredSessionTokenDecodeFailed:"expired-session-token-decode-failed",ExpiredSessionTokenMissingSidClaim:"expired-session-token-missing-sid-claim",FetchError:"fetch-error",UnexpectedSDKError:"unexpected-sdk-error",UnexpectedBAPIError:"unexpected-bapi-error"};async function authenticateRequest(e,t){let r=await createAuthenticateContext(createClerkRequest(e),t);assertValidSecretKey(r.secretKey),r.isSatellite&&(function(e,t){if(!e&&(0,i.CY)(t))throw Error("Missing signInUrl. Pass a signInUrl for dev instances if an app is satellite")}(r.signInUrl,r.secretKey),r.signInUrl&&r.origin&&function(e,t){let r;try{r=new URL(e)}catch{throw Error("The signInUrl needs to have a absolute url format.")}if(r.origin===t)throw Error("The signInUrl needs to be on a different origin than your satellite application.")}(r.signInUrl,r.origin),function(e){if(!e)throw Error("Missing domain and proxyUrl. A satellite application needs to specify a domain or a proxyUrl")}(r.proxyUrl||r.domain));let o=function(e){let t=null;if(e?.personalAccountPatterns)try{t=match(e.personalAccountPatterns)}catch(t){throw Error(`Invalid personal account pattern "${e.personalAccountPatterns}": "${t}"`)}let r=null;if(e?.organizationPatterns)try{r=match(e.organizationPatterns)}catch(t){throw Error(`Clerk: Invalid organization pattern "${e.organizationPatterns}": "${t}"`)}return{OrganizationMatcher:r,PersonalAccountMatcher:t}}(t.organizationSyncOptions);async function resolveHandshake(){let e=new Headers({"Access-Control-Allow-Origin":"null","Access-Control-Allow-Credentials":"true"}),t=await verifyHandshakeToken(r.handshakeToken,r),i=t.handshake,n="";if(i.forEach(t=>{e.append("Set-Cookie",t),getCookieName(t).startsWith(k.Cookies.Session)&&(n=getCookieValue(t))}),"development"===r.instanceType){let t=new URL(r.clerkUrl);t.searchParams.delete(k.QueryParameters.Handshake),t.searchParams.delete(k.QueryParameters.HandshakeHelp),e.append(k.Headers.Location,t.toString()),e.set(k.Headers.CacheControl,"no-store")}if(""===n)return signedOut(r,e4.SessionTokenMissing,"",e);let{data:o,errors:[l]=[]}=await verifyToken(n,r);if(o)return signedIn(r,o,e,n);if("development"===r.instanceType&&(l?.reason===a.YU.TokenExpired||l?.reason===a.YU.TokenNotActiveYet||l?.reason===a.YU.TokenIatInTheFuture)){l.tokenCarrier="cookie",console.error(`Clerk: Clock skew detected. This usually means that your system clock is inaccurate. Clerk will attempt to account for the clock skew in development.

To resolve this issue, make sure your system's clock is set to the correct time (e.g. turn off and on automatic time synchronization).

---

${l.getFullMessage()}`);let{data:t,errors:[i]=[]}=await verifyToken(n,{...r,clockSkewInMs:864e5});if(t)return signedIn(r,t,e,n);throw Error(i?.message||"Clerk: Handshake retry failed.")}throw Error(l?.message||"Clerk: Handshake failed.")}async function refreshToken(r){if(!t.apiClient)return{data:null,error:{message:"An apiClient is needed to perform token refresh.",cause:{reason:ta.MissingApiClient}}};let{sessionToken:i,refreshTokenInCookie:a}=r;if(!i)return{data:null,error:{message:"Session token must be provided.",cause:{reason:ta.MissingSessionToken}}};if(!a)return{data:null,error:{message:"Refresh token must be provided.",cause:{reason:ta.MissingRefreshToken}}};let{data:o,errors:l}=(0,n.t5)(i);if(!o||l)return{data:null,error:{message:"Unable to decode the expired session token.",cause:{reason:ta.ExpiredSessionTokenDecodeFailed,errors:l}}};if(!o?.payload?.sid)return{data:null,error:{message:"Expired session token is missing the `sid` claim.",cause:{reason:ta.ExpiredSessionTokenMissingSidClaim}}};try{let n=await t.apiClient.sessions.refreshSession(o.payload.sid,{format:"cookie",suffixed_cookies:r.usesSuffixedCookies(),expired_token:i||"",refresh_token:a||"",request_origin:r.clerkUrl.origin,request_headers:Object.fromEntries(Array.from(e.headers.entries()).map(([e,t])=>[e,[t]]))});return{data:n.cookies,error:null}}catch(e){if(!e?.errors?.length)return{data:null,error:{message:"Unexpected Server/BAPI error",cause:{reason:ta.UnexpectedBAPIError,errors:[e]}}};if("unexpected_error"===e.errors[0].code)return{data:null,error:{message:"Fetch unexpected error",cause:{reason:ta.FetchError,errors:e.errors}}};return{data:null,error:{message:e.errors[0].code,cause:{reason:e.errors[0].code,errors:e.errors}}}}}async function attemptRefresh(e){let{data:t,error:r}=await refreshToken(e);if(!t||0===t.length)return{data:null,error:r};let i=new Headers,n="";t.forEach(e=>{i.append("Set-Cookie",e),getCookieName(e).startsWith(k.Cookies.Session)&&(n=getCookieValue(e))});let{data:a,errors:o}=await verifyToken(n,e);return o?{data:null,error:{message:"Clerk: unable to verify refreshed session token.",cause:{reason:ta.InvalidSessionToken,errors:o}}}:{data:{jwtPayload:a,sessionToken:n,headers:i},error:null}}function handleMaybeHandshakeStatus(e,i,n,a){if(function(e){let{accept:t,secFetchDest:r}=e;return!!("document"===r||"iframe"===r||!r&&t?.startsWith("text/html"))}(e)){let l=a??function({handshakeReason:e}){let i=function(e){let t=new URL(e);return t.searchParams.delete(k.QueryParameters.DevBrowser),t.searchParams.delete(k.QueryParameters.LegacyDevBrowser),t}(r.clerkUrl),n=r.frontendApi.replace(/http(s)?:\/\//,""),a=new URL(`https://${n}/v1/client/handshake`);a.searchParams.append("redirect_url",i?.href||""),a.searchParams.append(k.QueryParameters.SuffixedCookies,r.usesSuffixedCookies().toString()),a.searchParams.append(k.QueryParameters.HandshakeReason,e),"development"===r.instanceType&&r.devBrowserToken&&a.searchParams.append(k.QueryParameters.DevBrowser,r.devBrowserToken);let l=getOrganizationSyncTarget(r.clerkUrl,t.organizationSyncOptions,o);if(l){let e=function(e){let t=new Map;return"personalAccount"===e.type&&t.set("organization_id",""),"organization"===e.type&&(e.organizationId&&t.set("organization_id",e.organizationId),e.organizationSlug&&t.set("organization_id",e.organizationSlug)),t}(l);e.forEach((e,t)=>{a.searchParams.append(t,e)})}return new Headers({[k.Headers.Location]:a.href})}({handshakeReason:i});l.get(k.Headers.Location)&&l.set(k.Headers.CacheControl,"no-store");let c=function(e){if(3===r.handshakeRedirectLoopCounter)return!0;let t=r.handshakeRedirectLoopCounter+1,i=k.Cookies.RedirectCount;return e.append("Set-Cookie",`${i}=${t}; SameSite=Lax; HttpOnly; Max-Age=3`),!1}(l);return c?(console.log("Clerk: Refreshing the session token resulted in an infinite redirect loop. This usually means that your Clerk instance keys do not match - make sure to copy the correct publishable and secret keys from the Clerk dashboard."),signedOut(e,i,n)):function(e,t,r="",i){return withDebugHeaders({status:e7.Handshake,reason:t,message:r,publishableKey:e.publishableKey||"",isSatellite:e.isSatellite||!1,domain:e.domain||"",proxyUrl:e.proxyUrl||"",signInUrl:e.signInUrl||"",signUpUrl:e.signUpUrl||"",afterSignInUrl:e.afterSignInUrl||"",afterSignUpUrl:e.afterSignUpUrl||"",isSignedIn:!1,headers:i,toAuth:()=>null,token:null})}(e,i,n,l)}return signedOut(e,i,n)}async function authenticateRequestWithTokenInHeader(){let{sessionTokenInHeader:e}=r;try{let{data:t,errors:i}=await verifyToken(e,r);if(i)throw i[0];return signedIn(r,t,void 0,e)}catch(e){return handleError(e,"header")}}async function authenticateRequestWithTokenInCookie(){let e=r.clientUat,i=!!r.sessionTokenInCookie,l=!!r.devBrowserToken;if(r.handshakeToken)try{return await resolveHandshake()}catch(e){e instanceof a.oh&&"development"===r.instanceType?function(e){if(e.reason===a.YU.TokenInvalidSignature)throw Error("Clerk: Handshake token verification failed due to an invalid signature. If you have switched Clerk keys locally, clear your cookies and try again.");throw Error(`Clerk: Handshake token verification failed: ${e.getFullMessage()}.`)}(e):console.error("Clerk: unable to resolve handshake:",e)}if("development"===r.instanceType&&r.clerkUrl.searchParams.has(k.QueryParameters.DevBrowser))return handleMaybeHandshakeStatus(r,e4.DevBrowserSync,"");let c=r.isSatellite&&"document"===r.secFetchDest;if("production"===r.instanceType&&c)return handleMaybeHandshakeStatus(r,e4.SatelliteCookieNeedsSyncing,"");if("development"===r.instanceType&&c&&!r.clerkUrl.searchParams.has(k.QueryParameters.ClerkSynced)){let e=new URL(r.signInUrl);e.searchParams.append(k.QueryParameters.ClerkRedirectUrl,r.clerkUrl.toString());let t=new Headers({[k.Headers.Location]:e.toString()});return handleMaybeHandshakeStatus(r,e4.SatelliteCookieNeedsSyncing,"",t)}let u=new URL(r.clerkUrl).searchParams.get(k.QueryParameters.ClerkRedirectUrl);if("development"===r.instanceType&&!r.isSatellite&&u){let e=new URL(u);r.devBrowserToken&&e.searchParams.append(k.QueryParameters.DevBrowser,r.devBrowserToken),e.searchParams.append(k.QueryParameters.ClerkSynced,"true");let t=new Headers({[k.Headers.Location]:e.toString()});return handleMaybeHandshakeStatus(r,e4.PrimaryRespondsToSyncing,"",t)}if("development"===r.instanceType&&!l)return handleMaybeHandshakeStatus(r,e4.DevBrowserMissing,"");if(!e&&!i)return signedOut(r,e4.SessionTokenAndUATMissing,"");if(!e&&i)return handleMaybeHandshakeStatus(r,e4.SessionTokenWithoutClientUAT,"");if(e&&!i)return handleMaybeHandshakeStatus(r,e4.ClientUATWithoutSessionToken,"");let{data:h,errors:p}=(0,n.t5)(r.sessionTokenInCookie);if(p)return handleError(p[0],"cookie");if(h.payload.iat<r.clientUat)return handleMaybeHandshakeStatus(r,e4.SessionTokenIATBeforeClientUAT,"");try{let{data:e,errors:i}=await verifyToken(r.sessionTokenInCookie,r);if(i)throw i[0];let n=signedIn(r,e,void 0,r.sessionTokenInCookie),a=function(e,r){let i=getOrganizationSyncTarget(e.clerkUrl,t.organizationSyncOptions,o);if(!i)return null;let n=!1;if("organization"===i.type&&(i.organizationSlug&&i.organizationSlug!==r.orgSlug&&(n=!0),i.organizationId&&i.organizationId!==r.orgId&&(n=!0)),"personalAccount"===i.type&&r.orgId&&(n=!0),!n)return null;if(e.handshakeRedirectLoopCounter>0)return console.warn("Clerk: Organization activation handshake loop detected. This is likely due to an invalid organization ID or slug. Skipping organization activation."),null;let a=handleMaybeHandshakeStatus(e,e4.ActiveOrganizationMismatch,"");return"handshake"!==a.status?null:a}(r,n.toAuth());if(a)return a;return n}catch(e){return handleError(e,"cookie")}return signedOut(r,e4.UnexpectedError)}async function handleError(t,i){let n;if(!(t instanceof a.oh))return signedOut(r,e4.UnexpectedError);if(t.reason===a.YU.TokenExpired&&r.refreshTokenInCookie&&"GET"===e.method){let{data:e,error:t}=await attemptRefresh(r);if(e)return signedIn(r,e.jwtPayload,e.headers,e.sessionToken);n=t?.cause?.reason?t.cause.reason:ta.UnexpectedSDKError}else n="GET"!==e.method?ta.NonEligibleNonGet:r.refreshTokenInCookie?null:ta.NonEligibleNoCookie;t.tokenCarrier=i;let o=[a.YU.TokenExpired,a.YU.TokenNotActiveYet,a.YU.TokenIatInTheFuture].includes(t.reason);return o?handleMaybeHandshakeStatus(r,convertTokenVerificationErrorReasonToAuthErrorReason({tokenError:t.reason,refreshError:n}),t.getFullMessage()):signedOut(r,t.reason,t.getFullMessage())}return r.sessionTokenInHeader?authenticateRequestWithTokenInHeader():authenticateRequestWithTokenInCookie()}var debugRequestState=e=>{let{isSignedIn:t,proxyUrl:r,reason:i,message:n,publishableKey:a,isSatellite:o,domain:l}=e;return{isSignedIn:t,proxyUrl:r,reason:i,message:n,publishableKey:a,isSatellite:o,domain:l}};function getOrganizationSyncTarget(e,t,r){if(!t)return null;if(r.OrganizationMatcher){let i;try{i=r.OrganizationMatcher(e.pathname)}catch(e){return console.error(`Clerk: Failed to apply organization pattern "${t.organizationPatterns}" to a path`,e),null}if(i&&"params"in i){let e=i.params;if("id"in e&&"string"==typeof e.id)return{type:"organization",organizationId:e.id};if("slug"in e&&"string"==typeof e.slug)return{type:"organization",organizationSlug:e.slug};console.warn("Clerk: Detected an organization pattern match, but no organization ID or slug was found in the URL. Does the pattern include `:id` or `:slug`?")}}if(r.PersonalAccountMatcher){let i;try{i=r.PersonalAccountMatcher(e.pathname)}catch(e){return console.error(`Failed to apply personal account pattern "${t.personalAccountPatterns}" to a path`,e),null}if(i)return{type:"personalAccount"}}return null}var convertTokenVerificationErrorReasonToAuthErrorReason=({tokenError:e,refreshError:t})=>{switch(e){case a.YU.TokenExpired:return`${e4.SessionTokenExpired}-refresh-${t}`;case a.YU.TokenNotActiveYet:return e4.SessionTokenNBF;case a.YU.TokenIatInTheFuture:return e4.SessionTokenIatInTheFuture;default:return e4.UnexpectedError}};function mergePreDefinedOptions(e,t){return Object.keys(e).reduce((e,r)=>({...e,[r]:t[r]||e[r]}),{...e})}var to={secretKey:"",jwtKey:"",apiUrl:void 0,apiVersion:void 0,proxyUrl:"",publishableKey:"",isSatellite:!1,domain:"",audience:""};function createAuthenticateRequest(e){let t=mergePreDefinedOptions(to,e.options),r=e.apiClient;return{authenticateRequest:(e,i={})=>{let{apiUrl:n,apiVersion:a}=t,o=mergePreDefinedOptions(t,i);return authenticateRequest(e,{...i,...o,apiUrl:n,apiVersion:a,apiClient:r})},debugRequestState}}},9646:function(e,t,r){r.d(t,{x9:function(){return a.x9},P:function(){return n.P},_d:function(){return n._d},CY:function(){return n.CY},nQ:function(){return n.nQ},XD:function(){return i.X}}),r(7521);var i=r(9792),n=r(1484),a=r(724);(0,r(1878).t5)({packageName:"@clerk/backend"});var{isDevOrStagingUrl:o}=(0,n.MY)()},1023:function(e,t,r){r.d(t,{l_:function(){return assertHeaderAlgorithm},jl:function(){return assertHeaderType},t5:function(){return decodeJwt},N7:function(){return hasValidSignature},GZ:function(){return l},$v:function(){return verifyJwt}});var i=r(7382);let n=crypto;var a=r(9953);r(7521);var o=fetch.bind(globalThis),l={crypto:n,get fetch(){return o},AbortController:globalThis.AbortController,Blob:globalThis.Blob,FormData:globalThis.FormData,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response},c={parse:(e,t)=>(function(e,t,r={}){if(!t.codes){t.codes={};for(let e=0;e<t.chars.length;++e)t.codes[t.chars[e]]=e}if(!r.loose&&e.length*t.bits&7)throw SyntaxError("Invalid padding");let i=e.length;for(;"="===e[i-1];)if(--i,!r.loose&&!((e.length-i)*t.bits&7))throw SyntaxError("Invalid padding");let n=new(r.out??Uint8Array)(i*t.bits/8|0),a=0,o=0,l=0;for(let r=0;r<i;++r){let i=t.codes[e[r]];if(void 0===i)throw SyntaxError("Invalid character "+e[r]);o=o<<t.bits|i,(a+=t.bits)>=8&&(a-=8,n[l++]=255&o>>a)}if(a>=t.bits||255&o<<8-a)throw SyntaxError("Unexpected end of data");return n})(e,u,t),stringify:(e,t)=>(function(e,t,r={}){let{pad:i=!0}=r,n=(1<<t.bits)-1,a="",o=0,l=0;for(let r=0;r<e.length;++r)for(l=l<<8|255&e[r],o+=8;o>t.bits;)o-=t.bits,a+=t.chars[n&l>>o];if(o&&(a+=t.chars[n&l<<t.bits-o]),i)for(;a.length*t.bits&7;)a+="=";return a})(e,u,t)},u={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},h={RS256:"SHA-256",RS384:"SHA-384",RS512:"SHA-512"},p="RSASSA-PKCS1-v1_5",m={RS256:p,RS384:p,RS512:p},g=Object.keys(h),isArrayString=e=>Array.isArray(e)&&e.length>0&&e.every(e=>"string"==typeof e),assertAudienceClaim=(e,t)=>{let r=[t].flat().filter(e=>!!e),n=[e].flat().filter(e=>!!e),a=r.length>0&&n.length>0;if(a){if("string"==typeof e){if(!r.includes(e))throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Invalid JWT audience claim (aud) ${JSON.stringify(e)}. Is not included in "${JSON.stringify(r)}".`})}else if(isArrayString(e)&&!e.some(e=>r.includes(e)))throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Invalid JWT audience claim array (aud) ${JSON.stringify(e)}. Is not included in "${JSON.stringify(r)}".`})}},assertHeaderType=e=>{if(void 0!==e&&"JWT"!==e)throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenInvalid,message:`Invalid JWT type ${JSON.stringify(e)}. Expected "JWT".`})},assertHeaderAlgorithm=e=>{if(!g.includes(e))throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenInvalidAlgorithm,message:`Invalid JWT algorithm ${JSON.stringify(e)}. Supported: ${g}.`})},assertSubClaim=e=>{if("string"!=typeof e)throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Subject claim (sub) is required and must be a string. Received ${JSON.stringify(e)}.`})},assertAuthorizedPartiesClaim=(e,t)=>{if(e&&t&&0!==t.length&&!t.includes(e))throw new i.oh({reason:i.YU.TokenInvalidAuthorizedParties,message:`Invalid JWT Authorized party claim (azp) ${JSON.stringify(e)}. Expected "${t}".`})},assertExpirationClaim=(e,t)=>{if("number"!=typeof e)throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Invalid JWT expiry date claim (exp) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),n=new Date(0);n.setUTCSeconds(e);let a=n.getTime()<=r.getTime()-t;if(a)throw new i.oh({reason:i.YU.TokenExpired,message:`JWT is expired. Expiry date: ${n.toUTCString()}, Current date: ${r.toUTCString()}.`})},assertActivationClaim=(e,t)=>{if(void 0===e)return;if("number"!=typeof e)throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Invalid JWT not before date claim (nbf) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),n=new Date(0);n.setUTCSeconds(e);let a=n.getTime()>r.getTime()+t;if(a)throw new i.oh({reason:i.YU.TokenNotActiveYet,message:`JWT cannot be used prior to not before date claim (nbf). Not before date: ${n.toUTCString()}; Current date: ${r.toUTCString()};`})},assertIssuedAtClaim=(e,t)=>{if(void 0===e)return;if("number"!=typeof e)throw new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Invalid JWT issued at date claim (iat) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),n=new Date(0);n.setUTCSeconds(e);let a=n.getTime()>r.getTime()+t;if(a)throw new i.oh({reason:i.YU.TokenIatInTheFuture,message:`JWT issued at date claim (iat) is in the future. Issued at date: ${n.toUTCString()}; Current date: ${r.toUTCString()};`})};async function hasValidSignature(e,t){let{header:r,signature:n,raw:o}=e,c=new TextEncoder,u=c.encode([o.header,o.payload].join(".")),p=function(e){let t=h[e],r=m[e];if(!t||!r)throw Error(`Unsupported algorithm ${e}, expected one of ${g.join(",")}.`);return{hash:{name:h[e]},name:m[e]}}(r.alg);try{let e=await function(e,t,r){if("object"==typeof e)return l.crypto.subtle.importKey("jwk",e,t,!1,[r]);let i=function(e){let t=e.replace(/-----BEGIN.*?-----/g,"").replace(/-----END.*?-----/g,"").replace(/\s/g,""),r=(0,a.S)(t),i=new ArrayBuffer(r.length),n=new Uint8Array(i);for(let e=0,t=r.length;e<t;e++)n[e]=r.charCodeAt(e);return n}(e),n="sign"===r?"pkcs8":"spki";return l.crypto.subtle.importKey(n,i,t,!1,[r])}(t,p,"verify"),r=await l.crypto.subtle.verify(p.name,e,n,u);return{data:r}}catch(e){return{errors:[new i.oh({reason:i.YU.TokenInvalidSignature,message:e?.message})]}}}function decodeJwt(e){let t=(e||"").toString().split(".");if(3!==t.length)return{errors:[new i.oh({reason:i.YU.TokenInvalid,message:"Invalid JWT form. A JWT consists of three parts separated by dots."})]};let[r,n,a]=t,o=new TextDecoder,l=JSON.parse(o.decode(c.parse(r,{loose:!0}))),u=JSON.parse(o.decode(c.parse(n,{loose:!0}))),h=c.parse(a,{loose:!0});return{data:{header:l,payload:u,signature:h,raw:{header:r,payload:n,signature:a,text:e}}}}async function verifyJwt(e,t){let{audience:r,authorizedParties:n,clockSkewInMs:a,key:o}=t,l=a||5e3,{data:c,errors:u}=decodeJwt(e);if(u)return{errors:u};let{header:h,payload:p}=c;try{let{typ:e,alg:t}=h;assertHeaderType(e),assertHeaderAlgorithm(t);let{azp:i,sub:a,aud:o,iat:c,exp:u,nbf:m}=p;assertSubClaim(a),assertAudienceClaim([o],[r]),assertAuthorizedPartiesClaim(i,n),assertExpirationClaim(u,l),assertActivationClaim(m,l),assertIssuedAtClaim(c,l)}catch(e){return{errors:[e]}}let{data:m,errors:g}=await hasValidSignature(c,o);return g?{errors:[new i.oh({action:i.h2.EnsureClerkJWT,reason:i.YU.TokenVerificationFailed,message:`Error verifying JWT signature. ${g[0]}`})]}:m?{data:p}:{errors:[new i.oh({reason:i.YU.TokenInvalidSignature,message:"JWT signature is invalid."})]}}}}]);